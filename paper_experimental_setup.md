# 实验设置 (Experimental Setup)

## 4.1 环境与协议

### 4.1.1 实验环境

本研究基于真实的美国墨西哥湾海事港口数据构建仿真环境，选择四个具有不同复杂度特征的港口进行实验：

- **Baton Rouge**: 内河港口，中等复杂度，3阶段课程学习
- **New Orleans**: 大型综合港口，最高复杂度，5阶段课程学习  
- **South Louisiana**: 工业港口，中等复杂度，3阶段课程学习
- **Gulfport**: 中型港口，较低复杂度，2阶段课程学习

每个港口的仿真环境包含5-20艘船舶和3-10个泊位，时间步长为1小时，单次episode长度为24小时。环境状态采用20维特征向量表示，包括港口负载、天气条件、船舶优先级等关键信息。

### 4.1.2 课程学习协议

采用从简单到复杂的渐进式训练策略，每个港口根据其复杂度设计2-5个训练阶段：

**阶段设计原则**：
- 流量强度：从0.3逐步增加到0.8
- 天气复杂度：从0.1逐步增加到0.6  
- 船舶数量：从5艘逐步增加到20艘
- 泊位数量：从3个逐步增加到10个

**阶段推进条件**：
- 每阶段训练30-50轮
- 胜率达到阶段特定阈值（0.35-0.50）方可进入下一阶段
- 采用Wilson 95%置信区间下界进行稳定性评估

### 4.1.3 性能评估阈值

基于历史数据和专家知识，为每个港口的各个阶段设定性能阈值：

| 港口 | 阶段 | 阈值 | 说明 |
|------|------|------|------|
| Baton Rouge | 基础阶段 | 41% | 内河港口基础调度 |
| Baton Rouge | 中级阶段 | 45% | 增加流量复杂度 |
| Baton Rouge | 高级阶段 | 39% | 最高复杂度场景 |
| New Orleans | 基础阶段 | 35% | 大型港口基础 |
| New Orleans | 初级阶段 | 40% | 船舶数量增加 |
| New Orleans | 中级阶段 | 50% | 中等复杂度 |
| New Orleans | 高级阶段 | 40% | 高复杂度场景 |
| New Orleans | 专家阶段 | 30% | 极限挑战 |
| South Louisiana | 基础阶段 | 41% | 工业港口基础 |
| South Louisiana | 中级阶段 | 45% | 中等复杂度 |
| South Louisiana | 高级阶段 | 39% | 高复杂度 |
| Gulfport | 标准阶段 | 49% | 标准调度场景 |
| Gulfport | 完整阶段 | 38% | 完整功能测试 |

### 4.1.4 联邦学习协议

采用FedAvg算法进行联邦学习，具体参数设置：
- 客户端总数：4个港口
- 每轮参与客户端数：4个（全参与）
- 通信轮数：10轮
- 本地训练轮数：每个客户端2轮
- 本地批次大小：10

### 4.1.5 持续集成(CI)规则

建立自动化的性能监控体系：

**夜间CI检查**：
- 执行时间：每晚2:00 AM
- 测试样本：800样本大测试
- 随机种子：[42, 123, 2025]多种子验证
- 告警条件：Wilson 95%置信区间下界 < 阈值 - 3pp

**稳定性评估**：
- 采用Wilson置信区间下界作为保守估计
- 3个百分点安全边界避免误报
- 多种子验证降低随机性影响
- 历史趋势分析支持长期监控

**质量保证**：
- 自动日志记录和状态跟踪
- 性能退化自动告警
- 支持四港口分批测试
- 14天日志自动清理

## 4.2 实验配置

### 4.2.1 硬件环境
- 处理器：Apple M1 Pro
- 内存：16GB
- 操作系统：macOS Monterey
- Python版本：3.11.8

### 4.2.2 软件依赖
- PyTorch：深度学习框架
- NumPy：数值计算
- Pandas：数据处理
- Matplotlib：可视化
- 完整依赖列表见requirements-lock.txt

### 4.2.3 版本控制
- Git Commit：a5b2665
- 环境快照：env_server.yml
- 依赖锁定：requirements-lock.txt (219个包)

### 4.2.4 可复现性保证
- 固定随机种子：[42, 123, 2025]
- 确定性算法设置
- 完整的环境和代码版本锁定
- 详细的实验日志记录

---

*注：本实验设置确保了结果的可复现性和统计显著性，为GAT-FedPPO算法的性能评估提供了可靠的基础。*